function DJDCalendar(a,b){"use strict";function c(a,b){if(!a||!a.parentNode)return null;var c,d,e,f=document.createElement(b||a.tagName),g=a.attributes;for(e=0;e<g.length;e++)c=g[e].nodeName,d=a.getAttribute(c),f.setAttribute(c,d);return a.parentNode.insertBefore(f,a),a.remove(),f}function d(){return"true"===$.cookie("show-weekends")?"Hide weekends":"Show weekends"}function e(){var a="true"===$.cookie("show-weekends");$.cookie("show-weekends",!a),location.reload()}function f(a){var b=$("#calendar-week"),c=b.val(),d="YYYY-[W]WW";c.match(/\d{2}\/\d{2}\/\d{4}/)&&(d="DD/MM/YYYY");var e=moment(a).format(d);b.val(e)}function g(a){location.hash="start="+moment(a).format("YYYY-MM-DD")}function h(a){var b=new CustomEvent("fullCalendarViewRender",{detail:a});document.dispatchEvent(b)}function i(a){f(a),h(a),g(a)}function j(a,b,c,d){v.getEvents(a,b).then(function(a){d(a[c])})["catch"](function(){})}function k(a,b){b[0]&&(b=b[0]),b.setAttribute("id","event-"+a.id),b.event=a;var d=b.querySelector(".fc-event-title"),e=c(d,"div");return e.innerHTML=a.title,a.tooltip&&b.setAttribute("title",a.tooltip),b}function l(a){return function(){var b=!1;return function(){if(b=!b){var c=80,d=a.querySelector(".fc-day-content"),e=d.clientHeight,f=e+c,g=Math.max(f,120);$(a).fullCalendar("option","contentHeight",g),$(a).parent().prev().css("height",g),$(".fc-event").not(":data(original-title),[data-original-title]").tooltip({container:"body",placement:"left"}).on("show.bs.tooltip",function(){$("a[aria-describedby^=tooltip]").tooltip("destroy")})}}}()}function m(a){i(a.start)}function n(a,b,c){var d=location.hash.match(/(\d{4})-(\d{2})-(\d{2})/),e=a.dataset.uid,f=$(a),g={left:"prev,next,today",center:"title",right:""};document.addEventListener("fullCalendarViewRender",function(a){var b=a.detail;f.fullCalendar("gotoDate",b)}),f.fullCalendar({weekends:"true"===$.cookie("show-weekends"),header:c?g:!1,defaultView:"basicWeek",editable:!1,droppable:!1,firstDay:1,titleFormat:{week:"MMMM d[, yyyy] '&ndash;'[ MMMM] d, yyyy"},columnFormat:{week:"ddd, MMM d"},year:d?d[1]:(new Date).getFullYear(),month:d?d[2]-1:(new Date).getMonth(),date:d?d[3]:(new Date).getDate(),eventClick:b,eventAfterAllRender:l(a),eventRender:k,viewRender:c?m:void 0,events:function(a,b,c){j(a,b,e,c)}})}function o(){var a=document.querySelector("#calendar-week");a.addEventListener("change",function(){var b="YYYY-[W]WW";a.value.match(/\d{2}\/\d{2}\/\d{4}/)&&(b="DD/MM/YYYY");var c=moment(a.value,b).weekday(1),d=c.valueOf();i(new Date(d))})}function p(a,b,c){var d="fc-day-header";"function"==typeof c&&a.addEventListener("click",function(e){if(e.target&&e.target.classList&&e.target.classList.contains(d)){var f=Array.prototype.slice.call(e.target.parentNode.children),g=f.indexOf(e.target),h=$(a).fullCalendar("getView"),i=moment(h.start).add(g,"days").toDate();c(i,b,e,h)}},!1)}function q(a,b,c){return"function"==typeof a&&b&&Array.isArray(c)?function(d){var e=$(b);if("function"==typeof e.fullCalendar){d.preventDefault();var f=e.fullCalendar("getView"),g=f.start,h=f.end;c.push(g),c.push(h),a.apply(d.target,c)}}:void 0}function r(a){$(".fc-button").addClass("btn");var b=document.createElement("span"),c=document.createElement("i");b.classList.add("fc-button"),b.classList.add("fc-button-refresh"),b.classList.add("fc-state-default"),b.classList.add("btn"),b.setAttribute("unselectable","on"),c.classList.add("fa"),c.classList.add("fa-refresh"),b.appendChild(c),b.addEventListener("click",function(){y.reload()}),a.querySelector(".fc-header-left").appendChild(b);var f=document.createElement("span");f.classList.add("fc-button"),f.classList.add("fc-button-show-weekends"),f.classList.add("fc-state-default"),f.classList.add("fc-corner-right"),f.classList.add("btn"),f.setAttribute("unselectable","on"),f.innerText=d(),f.addEventListener("click",function(){e()}),a.querySelector(".fc-header-right").appendChild(f)}function s(a,b){var c=[],d=document.createDocumentFragment(),e=document.createElement("div");e.classList.add("box"),d.appendChild(e);var f=document.createElement("div");f.classList.add("box-title"),e.appendChild(f);var g=document.createElement("div");g.classList.add("box-content"),e.appendChild(g);var h=document.createElement("div");h.classList.add("row"),g.appendChild(h);var i=document.createElement("div");i.classList.add("col-md-12"),i.classList.add("calendars"),h.appendChild(i);var j=document.createElement("div");j.classList.add("row"),j.classList.add("week"),i.appendChild(j);var k=document.createElement("div");k.classList.add("col-md-2"),j.appendChild(k),w=document.createElement("input"),w.classList.add("form-control"),w.setAttribute("type","week"),w.setAttribute("id","calendar-week"),w.value=moment(new Date).format("YYYY-[W]WW").valueOf(),k.appendChild(w);var l,m,n,o,p,r,s,t;for(t=0;t<b.length;t++){l=b[t],m=document.createElement("div"),m.classList.add("row"),i.appendChild(m),n=document.createElement("div"),n.classList.add("col-md-2"),m.appendChild(n),o=document.createElement("span"),n.appendChild(o),p=document.createElement("a"),o.appendChild(p),"string"==typeof l.uid&&(r=document.createElement("i"),r.classList.add("fa"),r.classList.add("fa-map-marker"),p.appendChild(r),l.description&&(p.appendChild(document.createElement("br")),s=document.createElement("em"),s.innerText=l.description,p.appendChild(s))),p.innerText+=l.name;var u=document.createElement("div");u.classList.add("col-md-10"),m.appendChild(u);var v=document.createElement("div");v.classList.add(x),v.dataset.uid=l.uid,u.appendChild(v),b[t].element=v,"function"==typeof l.titleClick&&(p.setAttribute("href","#"),p.addEventListener("click",q(l.titleClick,v,[l.uid]))),c[t]=v}return a.appendChild(d),c}function t(a){y.reload=function(){v.load().then(function(){for(var b=0;b<a.length;b++)$(a[b]).fullCalendar("refetchEvents")})}}function u(a,b){if(!a||"object"!=typeof b)throw new Error("Unable to create calendar. Invalid parameters");"string"==typeof a&&(a=document.querySelector(a));var c,d=b,e=s(a,d.calendars);if(!e)return void console.error("Error creating calendars.");t(e);var f=[];for(c=0;c<d.calendars.length;c++)f.push(d.calendars[c].uid);v.init(f,d.loadUrl);var g,h;for(c=0;c<e.length;c++)g=e[c],h=d.calendars[c],n(g,h.eventClick,0===c),"function"==typeof h.dayHeaderClick&&p(g,h.uid,h.dayHeaderClick),0===c&&r(g);B(),o(),z(!0),$(".show-all-staff").click(A)}if(!(this instanceof DJDCalendar))return new DJDCalendar(arguments[0],arguments[1]);var v,w,x="js-cal-calendar",y=this;v=function(){function a(a,b){i=!0,d=b,e=a}function b(a,b){return i&&(a||g)?(a=a||g,b=b||h,j?Promise.resolve(f):($("#loading").show(),j=!0,f=new Promise(function(c,f){$.ajax({type:"post",url:d,dataType:"json",cache:!1,data:{uid:e,start:moment(a).format("X"),end:moment(b).format("X")},success:function(d){return $("#loading").hide(),null===d?(alert("Error fetching events. Please refresh."),void f(!1)):(g=a,h=b,j=!1,void c(d))}})}))):Promise.reject()}function c(a,c){var d;if(!(a&&a.valueOf&&c&&c.valueOf))return Promise.reject();var e;return g&&h&&(e=g.valueOf()===a.valueOf()&&h.valueOf()===c.valueOf()),e?d=Promise.resolve(f):f?(d=Promise.resolve(f),b(a,c)):d=b(a,c),d}var d,e,f,g,h,i=!1,j=!1;return{init:a,load:b,getEvents:c}}();var z=function(){function a(){y.reload()}var b;return function(c){c?b=setInterval(a,6e4):clearInterval(b)}}(),A=function(){var a="true"===$.cookie("show-staff");$.cookie("show-staff",!a),location.reload()},B=function(){var a=$(".box-title"),b=$(".fc-header:eq(0)"),c=b.innerWidth();window.addEventListener("scroll",$.throttle(100,function(){a.visible(!0)?b.removeClass("sticky").css("width","100%"):"static"===b.css("position")&&b.addClass("sticky").css("width",c+"px")}))};u(a,b),this.init=u}
//# sourceMappingURL=multi-calendar.map