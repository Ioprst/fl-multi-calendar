function debounce(a,b){function c(){e&&clearTimeout(e),a.apply(g,d)}var d,e,f=b,g=this;return function(){return d=arguments,e&&clearTimeout(e),e=setTimeout(c,f),function(a){a&&c()}}}function MultiCalendar(a){"use strict";function b(a,b){if(!a||!a.parentNode)return null;var c,d,e,f=document.createElement(b||a.tagName),g=a.attributes;for(e=0;e<g.length;e++)c=g[e].nodeName,d=a.getAttribute(c),f.setAttribute(c,d);return a.parentNode.insertBefore(f,a),a.remove(),f}function c(){return"true"===$.cookie("show-weekends")?"Hide weekends":"Show weekends"}function d(){u=!u,u?q.setViewType("basicWeek"):q.setViewType("basicDay")}function e(a,b,c,d){o.getEvents(a,b).then(function(a){d(a[c])})["catch"](function(){})}function f(a,c){c[0]&&(c=c[0]),c.setAttribute("id","event-"+a.id),c.event=a;var d=c.querySelector(".fc-title"),e=b(d,"div");if(e.innerHTML=a.title,a.tooltip){c.classList.add("fc-tooltip");var f=document.createElement("span");f.classList.add("fc-tooltiptext"),f.innerText=a.tooltip,c.appendChild(f)}return c}function g(a){q.setDate(a.start)}function h(a,b,c){var d=location.hash.match(/(\d{4})-(\d{2})-(\d{2})/),h=a.dataset.uid,i=$(a),j={left:"prev,next,today",center:"title",right:""};document.addEventListener("fullCalendarViewRender",function(a){var b=a.detail;i.fullCalendar("gotoDate",b)}),document.addEventListener("multiCalendarViewChange",function(a){var b=a.detail;i.fullCalendar("changeView",b)}),i.fullCalendar({weekends:"true"===$.cookie("show-weekends"),header:c?j:!1,defaultView:q.getViewType(),contentHeight:"auto",editable:!1,droppable:!1,firstDay:1,timeFormat:"",titleFormat:{week:"MMM D YYYY"},columnFormat:{week:"ddd, MMM D"},year:d?d[1]:(new Date).getFullYear(),month:d?d[2]-1:(new Date).getMonth(),date:d?d[3]:(new Date).getDate(),eventClick:b,eventRender:f,viewRender:c?g:void 0,events:function(a,b,c,d){e(a,b,h,d)}})}function i(a,b,c){var d="fc-day-header";"function"==typeof c&&a.addEventListener("click",function(e){if(e.target&&e.target.classList&&e.target.classList.contains(d)){var f=Array.prototype.slice.call(e.target.parentNode.children),g=f.indexOf(e.target),h=$(a).fullCalendar("getView"),i=moment(h.start).add(g,"days").toDate();c(i,b,e,h)}},!1)}function j(a,b,c){return"function"==typeof a&&b&&Array.isArray(c)?function(d){var e=$(b);if("function"==typeof e.fullCalendar){d.preventDefault();var f=e.fullCalendar("getView"),g=f.start,h=f.end;c.push(g),c.push(h),a.apply(d.target,c)}}:void 0}function k(a){$(".fc-button").addClass("btn");var b=document.createElement("button"),e=document.createElement("i");b.classList.add("fc-button"),b.classList.add("fc-button-refresh"),b.classList.add("fc-state-default"),b.classList.add("fl-refresh-btn"),b.classList.add("btn"),b.setAttribute("unselectable","on"),e.classList.add("icon"),e.classList.add("icon-refresh"),p.setLoadingElement(e),b.appendChild(e),b.addEventListener("click",function(){s.reload()}),a.querySelector(".fc-left").appendChild(b);var f=document.createElement("button");f.classList.add("fc-button"),f.classList.add("fc-button-show-weekends"),f.classList.add("fc-state-default"),f.classList.add("fc-corner-right"),f.classList.add("btn"),f.setAttribute("unselectable","on"),f.innerText=c(),f.addEventListener("click",function(){d()}),a.querySelector(".fc-right").appendChild(f)}function l(a,b){var c=[],d=document.createDocumentFragment(),e=document.createElement("div");e.classList.add("box"),d.appendChild(e);var f=document.createElement("div");f.classList.add("box-title"),e.appendChild(f);var g=document.createElement("div");g.classList.add("box-content"),e.appendChild(g);var h=document.createElement("div");h.classList.add("row"),g.appendChild(h);var i=document.createElement("div");i.classList.add("col-md-12"),i.classList.add("calendars"),h.appendChild(i);var k,l,m,n,o,p,s,t;for(t=0;t<b.length;t++){if(k=b[t],l=document.createElement("div"),l.classList.add("row"),i.appendChild(l),m=document.createElement("div"),m.classList.add("fl-row-title"),0===t){var u=document.createElement("div");u.classList.add("col-md-2");var v=document.createElement("div");v.classList.add("row"),u.appendChild(v);var w=document.createElement("div");w.classList.add("col-sm-12"),w.classList.add("week"),v.appendChild(w);var x=document.createElement("input");x.classList.add("form-control"),x.setAttribute("type","week"),x.classList.add("fl-weekpicker"),q.setWeekPicker(x),w.appendChild(x),m.classList.add("col-sm-12"),v.appendChild(m),l.appendChild(u)}else m.classList.add("col-md-2"),l.appendChild(m);n=document.createElement("span"),m.appendChild(n),o=document.createElement("a"),n.appendChild(o),"string"==typeof k.uid&&(p=document.createElement("i"),p.classList.add("fa"),p.classList.add("fa-map-marker"),o.appendChild(p),k.description&&(n.appendChild(document.createElement("br")),s=document.createElement("em"),s.innerText=k.description,n.appendChild(s))),o.innerHTML+=k.name;var y=document.createElement("div");y.classList.add("col-md-10"),l.appendChild(y);var z=document.createElement("div");z.classList.add(r),z.dataset.uid=k.uid,y.appendChild(z),b[t].element=z,"function"==typeof k.titleClick&&(o.setAttribute("href","#"),o.addEventListener("click",j(k.titleClick,z,[k.uid]))),c[t]=z}return a.appendChild(d),c}function m(a){s.reload=function(){o.load().then(function(){for(var b=0;b<a.length;b++)$(a[b]).fullCalendar("refetchEvents")})}}function n(a){if("object"!=typeof a)throw new Error("init(): Unable to create calendar. Invalid parameters");if(!a.targetEl)throw new Error("init(): No target element provided");var b=a.targetEl;if("string"==typeof b&&(b=document.querySelector(b),!b))throw new Error("init(): targetEl string selector did not return an HTMLElement.");var c,d=a;p.on("show",a.loadingAnimationStart),p.on("hide",a.loadingAnimationStop);var e=l(b,d.calendars);if(!e)throw new Error("Error creating calendars.");m(e);var f=[];for(c=0;c<d.calendars.length;c++)f.push(d.calendars[c].uid);o.init(f,d.loadUrl);var g,j;for(c=0;c<e.length;c++)g=e[c],j=d.calendars[c],h(g,j.eventClick,0===c),"function"==typeof j.dayHeaderClick&&i(g,j.uid,j.dayHeaderClick),0===c&&k(g);w(),t(!0),x(),$(".show-all-staff").click(v)}if(!(this instanceof MultiCalendar))return new MultiCalendar(arguments[0]);var o,p,q,r="fl-multi-calendar",s=this;p=function(){var a,b,c;return{show:function(){a&&a.classList.add("rotate")},hide:function(){a&&a.classList.remove("rotate")},on:function(a,d){if(d&&"function"!=typeof d&&console.error("loading.on(): The parameter provided is not a function."),a&&"SHOW"===a.toUpperCase())b=d;else{if(!a||"HIDE"!==a.toUpperCase())throw new Error('loading.on(): "'+a+'" is not a valid parameter option.');c=d}},setLoadingElement:function(b){if("object"!=typeof b)throw new Error("setLoadingElement(): Invalid parameter for loading element.");a=b}}}(),q=function(){function a(a){k.value=moment(a).format(l[m].format)}function b(a){k.setAttribute("type",a)}function c(a){location.hash="start="+moment(a).format("YYYY-MM-DD")}function d(a){a=moment(a);var b=new CustomEvent("fullCalendarViewRender",{detail:a});document.dispatchEvent(b)}function e(a){var b=new CustomEvent("multiCalendarViewChange",{detail:a});document.dispatchEvent(b)}function f(){return moment(n)}function g(b){b=moment(b);var e=moment(n);0!==e.diff(b,l[m].type)&&(n=b.format(l[m].format),a(n),d(n),c(b))}function h(b){if(!b)throw new Error("setWeekPicker(): Invalid element as weekpicker.");k=b,a(n),b.addEventListener("change",function(){g(b.value)})}function i(c){for(var d=-1,f=0;f<l.length;f++)if(l[f].name===c){d=f;break}0>d?console.error("setViewType(): Invalid view type."):d!==m&&(m=d,n=moment(n).format(l[m].format),e(l[m].name),b(l[m].weekPickerType),a(n))}function j(){return l[m].name}var k,l=[{name:"basicDay",type:"day",weekPickerType:"date",format:"YYYY-MM-DD"},{name:"basicWeek",type:"week",weekPickerType:"week",format:"YYYY-[W]WW"}],m=1,n=moment().format(l[m].format);return{getDate:f,setDate:g,setWeekPicker:h,setViewType:i,getViewType:j}}(),o=function(){function a(a,b){i=!0,d=b,e=a}function b(a,b){if(!i||!a&&!g)return Promise.reject();if(a=a||g,b=b||h,j)return Promise.resolve(f);p.show(),j=!0;var c={method:"POST",cache:"no-cache",headers:new Headers({"Content-Type":"application/json"}),body:{uid:e,start:moment(a).format("X"),end:moment(b).format("X")}};return f=fetch(d,c).then(function(a){return a.json()}).then(function(c){return p.hide(),null===c?(alert("Error fetching events. Please refresh."),null):(g=a,h=b,j=!1,c)})["catch"](function(a){return a})}function c(a,c){var d;if(!(a&&a.valueOf&&c&&c.valueOf))return Promise.reject();var e;return g&&h&&(e=g.valueOf()===a.valueOf()&&h.valueOf()===c.valueOf()),e?d=Promise.resolve(f):f?(d=Promise.resolve(f),b(a,c)):d=b(a,c),d}var d,e,f,g,h,i=!1,j=!1;return{init:a,load:b,getEvents:c}}();var t=function(){function a(){s.reload()}var b;return function(c){c?b=setInterval(a,6e4):clearInterval(b)}}(),u=!1,v=function(){var a="true"===$.cookie("show-staff");$.cookie("show-staff",!a),location.reload()},w=function(){var a=$(".box-title"),b=$(".fc-toolbar"),c=b.innerWidth();window.addEventListener("scroll",$.throttle(100,function(){a.visible(!0)?b.removeClass("sticky").css("width","100%"):"static"===b.css("position")&&b.addClass("sticky").css("width",c+"px")}))},x=function(){function a(){var a=q.getViewType(),c=window.innerWidth;600>=c&&a!==b?q.setViewType(b):c>600&&a===b&&q.setViewType("basicWeek")}var b="basicDay";window.addEventListener("resize",debounce(a,300)),a(),x=function(){}};n(a),this.init=n}xController(function(a){"use strict";var b=window[a.dataset.config];if("object"!=typeof b)throw new Error("x-div multiCalendar: No configuration object provided.");b.targetEl=a,new MultiCalendar(b)});
//# sourceMappingURL=multi-calendar.map